<!doctype html>
<html class="no-js" lang="zxx">

<head>
    <!-- Meta Tags -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="keywords" content="Site keywords here">
    <meta name="description" content="">
    <meta name='copyright' content=''>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Title -->
    <title>Posy - Mental Health Consultant</title>

    <!-- Favicon -->
    <link rel="icon" href="img/favicon.png">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Poppins:200i,300,300i,400,400i,500,500i,600,600i,700,700i,800,800i,900,900i&display=swap" rel="stylesheet">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <!-- Nice Select CSS -->
    <link rel="stylesheet" href="css/nice-select.css">
    <!-- Font Awesome CSS -->
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <!-- icofont CSS -->
    <link rel="stylesheet" href="css/icofont.css">
    <!-- Slicknav -->
    <link rel="stylesheet" href="css/slicknav.min.css">
    <!-- Owl Carousel CSS -->
    <link rel="stylesheet" href="css/owl-carousel.css">
    <!-- Datepicker CSS -->
    <link rel="stylesheet" href="css/datepicker.css">
    <!-- Animate CSS -->
    <link rel="stylesheet" href="css/animate.min.css">
    <!-- Magnific Popup CSS -->
    <link rel="stylesheet" href="css/magnific-popup.css">

    <!-- Medipro CSS -->
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="css/responsive.css">

    <style>
        .main {
            background: #f8f8f8;
            padding: 80px 0;
        }
        
        .container {
            background: #fff;
            border-radius: 20px;
            box-shadow: 0 15px 16.83px 0.17px rgba(0, 0, 0, 0.05);
            max-width: 1000px;
        }
        
        .signup-content {
            display: flex;
            padding: 50px 0;
            align-items: center;
        }
        
        .signup-image,
        .signup-form {
            width: 50%;
            padding: 0 40px;
        }
        
        .signup-image figure {
            margin-bottom: 20px;
        }
        
        .signup-image img {
            max-width: 100%;
            border-radius: 10px;
        }
        
        .form-title {
            font-size: 28px;
            color: #333;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .form-group {
            margin-bottom: 25px;
            position: relative;
        }
        
        .form-group input {
            width: 100%;
            padding: 12px 30px;
            border: none;
            border-bottom: 2px solid #e6e6e6;
            font-size: 15px;
            transition: all 0.3s ease;
            background: transparent;
        }
        
        .form-group input:focus {
            border-bottom-color: #6dabe4;
        }
        
        .form-group label {
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            color: #666;
        }
        
        .form-submit {
            background: #2074d4;
            color: #fff;
            border: none;
            width: 100%;
            padding: 15px 40px;
            border-radius: 5px;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .form-submit:hover {
            background: #2074d4;
            color: #fff;
        }
        
        .signin-image-link {
            color: #6dabe4;
            text-decoration: none;
            display: block;
            text-align: center;
            margin-top: 20px;
            transition: color 0.3s ease;
        }
        
        .signin-image-link:hover {
            color: #4292dc;
        }
        
        @media (max-width: 768px) {
            .signup-content {
                flex-direction: column;
            }
            .signup-image,
            .signup-form {
                width: 100%;
                padding: 0 20px;
            }
            .signup-image {
                order: 2;
                margin-top: 30px;
            }
            .signup-form {
                order: 1;
            }
        }
    </style>
</head>

<body>

    <!-- Preloader -->
    <div class="preloader">
        <div class="loader">
            <div class="loader-outter"></div>
            <div class="loader-inner"></div>

            <div class="indicator">
                <svg width="16px" height="12px">
                        <polyline id="back" points="1 6 4 6 6 11 10 1 12 6 15 6"></polyline>
                        <polyline id="front" points="1 6 4 6 6 11 10 1 12 6 15 6"></polyline>
                    </svg>
            </div>
        </div>
    </div>
    <!-- End Preloader -->

    <!-- Header Area -->
    <header class="header">
        <!-- Header Inner -->
        <div class="header-inner">
            <div class="container">
                <div class="inner">
                    <div class="row">
                        <div class="col-lg-3 col-md-3 col-12">
                            <!-- Start Logo -->
                            <div class="logo">
                                <a href="index.html"><img src="images/logo_cbg.png" alt="Posy"></a>
                            </div>
                            <!-- End Logo -->
                            <!-- Mobile Nav -->
                            <div class="mobile-nav"></div>
                            <!-- End Mobile Nav -->
                        </div>
                        <div class="col-lg-7 col-md-9 col-12">
                        </div>
                        <div class="col-lg-2 col-12">
                            <div class="get-quote">
                                <a href="login.html" class="btn">Get Started</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--/ End Header Inner -->
    </header>
    <!-- End Header Area -->

    <body>

        <!-- Main Content -->
        <div class="main">
            <section class="sign-up">
                <div class="container">
                    <div class="signup-content">
                        <div class="signup-form">
                            <h2 class="form-title">Create Account</h2>
                            <form class="register-form" id="register-form" onsubmit="handleRegister(event)">
                                <div class="form-group">
                                    <label for="name"><i class="icofont-user"></i></label>
                                    <input type="text" name="name" id="name" placeholder="Full Name" required />
                                </div>
                                <div class="form-group">
                                    <label for="email"><i class="icofont-email"></i></label>
                                    <input type="email" name="email" id="email" placeholder="Email Address" required />
                                </div>
                                <div class="form-group">
                                    <label for="password"><i class="icofont-lock"></i></label>
                                    <input type="password" name="password" id="password" placeholder="Password" required />
                                </div>
                                <div class="form-group">
                                    <label for="confirm-password"><i class="icofont-lock"></i></label>
                                    <input type="password" name="confirm-password" id="confirm-password" placeholder="Confirm Password" required />
                                </div>
                                <div id="psychiatrist-fields" style="display: none;">
                                    <div class="form-group">
                                        <label for="license"><i class="icofont-certificate"></i></label>
                                        <input type="text" name="license" id="license" placeholder="License Number" />
                                    </div>
                                    <div class="form-group">
                                        <label for="specialization"><i class="icofont-medical"></i></label>
                                        <input type="text" name="specialization" id="specialization" placeholder="Specialization" />
                                    </div>
                                    <div class="form-group">
                                        <label for="experience"><i class="icofont-calendar"></i></label>
                                        <input type="number" name="experience" id="experience" placeholder="Years of Experience" min="0" />
                                    </div>
                                </div>
                                <div class="form-group form-button">
                                    <input type="submit" name="signup" id="signup" class="form-submit" value="Register" />
                                </div>
                            </form>
                            <p>Already have an account? <a href="login.html" class="signin-image-link">Login here</a></p>
                        </div>
                        <div class="signup-image">
                            <figure><img src="images/doctor_cbg.png" alt="Mental Health Professional"></figure>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <!-- jquery Min JS -->
        <script src="js/jquery.min.js"></script>
        <!-- jquery Migrate JS -->
        <script src="js/jquery-migrate-3.0.0.js"></script>
        <!-- jquery Ui JS -->
        <script src="js/jquery-ui.min.js"></script>
        <!-- Easing JS -->
        <script src="js/easing.js"></script>
        <!-- Color JS -->
        <script src="js/colors.js"></script>
        <!-- Popper JS -->
        <script src="js/popper.min.js"></script>
        <!-- Bootstrap Datepicker JS -->
        <script src="js/bootstrap-datepicker.js"></script>
        <!-- Jquery Nav JS -->
        <script src="js/jquery.nav.js"></script>
        <!-- Slicknav JS -->
        <script src="js/slicknav.min.js"></script>
        <!-- ScrollUp JS -->
        <script src="js/jquery.scrollUp.min.js"></script>
        <!-- Niceselect JS -->
        <script src="js/niceselect.js"></script>
        <!-- Tilt Jquery JS -->
        <script src="js/tilt.jquery.min.js"></script>
        <!-- Owl Carousel JS -->
        <script src="js/owl-carousel.js"></script>
        <!-- counterup JS -->
        <script src="js/jquery.counterup.min.js"></script>
        <!-- Steller JS -->
        <script src="js/steller.js"></script>
        <!-- Wow JS -->
        <script src="js/wow.min.js"></script>
        <!-- Magnific Popup JS -->
        <script src="js/jquery.magnific-popup.min.js"></script>
        <!-- Counter Up CDN JS -->
        <script src="http://cdnjs.cloudflare.com/ajax/libs/waypoints/2.0.3/waypoints.min.js"></script>
        <!-- Bootstrap JS -->
        <script src="js/bootstrap.min.js"></script>
        <!-- Main JS -->
        <script src="js/main.js"></script>
        <script>
            // Since all registrations from this page are for psychiatrists,
            // show the psychiatrist fields by default
            document.addEventListener('DOMContentLoaded', function() {
                const psychiatristFields = document.getElementById('psychiatrist-fields');
                psychiatristFields.style.display = 'block';
            });

            async function handleRegister(event) {
                event.preventDefault();

                const name = document.getElementById('name').value;
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                const confirmPassword = document.getElementById('confirm-password').value;
                // Set role as 'psychiatrist' for all registrations from this page
                const role = 'psychiatrist';

                // Validate passwords match
                if (password !== confirmPassword) {
                    alert('Passwords do not match');
                    return;
                }

                // Create registration data
                const userData = {
                    name: name,
                    email: email,
                    password: password,
                    role: role
                };

                // Add psychiatrist-specific fields if role is psychiatrist
                if (role === 'psychiatrist') {
                    userData.license = document.getElementById('license').value;
                    userData.specialization = document.getElementById('specialization').value;
                    userData.experience = document.getElementById('experience').value;
                }

                try {
                    const response = await fetch('http://localhost:8000/auth/register', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(userData)
                    });

                    const data = await response.json();

                    if (response.ok) {
                        alert('Registration successful! Please login.');
                        window.location.href = 'login.html';
                    } else {
                        // Handle error response properly
                        let errorMessage = 'Registration failed';
                        if (data && typeof data === 'object') {
                            // If data.detail exists, use it as the error message
                            if (data.detail) {
                                errorMessage += ': ' + data.detail;
                            } else if (data.message) {
                                errorMessage += ': ' + data.message;
                            } else {
                                // If no specific error message, stringify the entire object
                                errorMessage += ': ' + JSON.stringify(data);
                            }
                        }
                        alert(errorMessage);
                    }
                } catch (error) {
                    console.error('Error:', error);
                    alert('An error occurred during registration. Please try again.');
                }
            }
        </script>
    </body>

</html>